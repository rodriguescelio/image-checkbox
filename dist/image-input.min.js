!function(t){"use strict";t.fn.imageInput=function(n){function i(){a.addClass("image-input-struct"),a.each(function(n,i){var u=t(i).attr("data-input-name"),r=t(i).attr("data-input-class"),l=a.selector;if(!(u&&""!==u||r&&""!==r))return void console.warn("Set a name or class for this imageInput: "+l);var p=t("<input>",{type:"hidden"});a.append(p),u&&""!==u&&p.attr("name",u),e.multiple===!0&&(p=t("<input>",{type:"hidden","class":"image-input-value-control"}),a.append(p)),r&&""!==r&&p.addClass(r);var c=t(i).find("img");c.each(function(n,i){var a=t(i).attr("data-value"),u=o(a),e=i.outerHTML;t(u).append(e),i.outerHTML=u[0].outerHTML})}),d(a),x()}var a=t(this),u={multiple:!1,borderColor:"#ff1a1a",iconColor:"#FFFFFF",imagesPerLine:5},e=t.extend(u,n),o=function(n){var i=t("<div>",{"class":"image-input-option","data-input-value":n}),a=t("<div>",{"class":"image-input-flag"}).html("<i></i>");return i.html(a),i},r=function(n,i){i=100/i;var a=t(n).width(),u=a*i/100;return u-25},l=function(t){return'<svg height="24px" width="24px" version="1.1" xml:space="preserve" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"><g><g><path fill="'+t+'" d="M12,0C5.373,0,0,5.373,0,12c0,6.628,5.373,12,12,12c6.627,0,12-5.372,12-12C24,5.373,18.627,0,12,0z M19.754,9.561    l-8.607,8.607c-0.176,0.177-0.462,0.177-0.637,0l-1.272-1.285c-0.175-0.176-0.462-0.464-0.636-0.642l-2.96-3.112    c-0.087-0.087-0.133-0.21-0.133-0.327c0-0.115,0.046-0.227,0.133-0.314l1.297-1.169c0.088-0.09,0.205-0.134,0.321-0.134    c0.114,0.001,0.228,0.046,0.315,0.134l2.936,2.995c0.175,0.178,0.461,0.178,0.637,0l6.699-6.681c0.176-0.177,0.461-0.177,0.636,0    l1.272,1.285C19.93,9.094,19.93,9.384,19.754,9.561z"/></g></g></svg>'},p=function(t){var n=t.val(),i=null;return i=""===n?[]:n.split(", ")},c=function(t,n){for(var i in t)n.call(this,i,t[i])},d=function(t){t.find(".image-input-option").css("width",r(t,e.imagesPerLine));var n=t.find(".image-input-option"),i=n.find(".image-input-flag"),a=i.find("i"),u=l(e.iconColor);i.css("border-top","50px solid "+e.borderColor),a.css("background-image","url('data:image/svg+xml;utf8,"+u+"')"),t.attr("data-multi",e.multiple)},s=function(t,n){t.find('input:not(.image-input-value-control)[value="'+n+'"]').eq(0).remove();var i=t.find("input.image-input-value-control"),a=p(i);c(a,function(t,i){i==n&&a.splice(t,1)}),a=a.join(", "),i.val(a)},f=function(n,i){var a=n.attr("data-input-name"),u=t("<input>",{type:"hidden",name:a,value:i});n.append(u);var e=n.find("input.image-input-value-control"),o=p(e);o.push(i),o=o.join(", "),e.val(o)},v=function(t,n){var i=t.find("input");i.val(n)},g=function(t){t.attr("data-input-focus",!0),t.find(".image-input-flag").show(),t.css("outline","solid 2px "+e.borderColor)},m=function(t){t.attr("data-input-focus",!1),t.find(".image-input-flag").hide(),t.css("outline","none")},h=function(n){var i=n.find(".image-input-option");i.each(function(n,i){i=t(i);var a=i.attr("data-input-focus");"true"==a&&m(i)})},w=function(t,n){var i=null;i="true"==n?t.find("input.image-input-value-control"):t.find("input"),i.change()},x=function(){t(".image-input-option").click(function(n){var i=t(this),a=i.parent(),u=a.attr("data-multi"),e=i.attr("data-input-value"),o=i.attr("data-input-focus");void 0!==o&&""!==o||(o="false"),"true"==u?("true"==o?(s(a,e),m(i)):(f(a,e),g(i)),w(a,u)):"false"==o&&(v(a,e),h(a),g(i),w(a,u))})};i()}}(jQuery);